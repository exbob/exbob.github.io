<!doctype html><html lang=zh-Hans dir=Chinese-Simplified class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#FFFFFF"><title>Linux Wireless HowTo &#183; Shaocheng.Li</title>
<meta name=title content="Linux Wireless HowTo &#183; Shaocheng.Li"><script type=text/javascript src=/js/appearance.min.8a082f81b27f3cb2ee528df0b0bdc39787034cf2cc34d4669fbc9977c929023c.js integrity="sha256-iggvgbJ/PLLuUo3wsL3Dl4cDTPLMNNRmn7yZd8kpAjw="></script><link type=text/css rel=stylesheet href=/css/main.bundle.min.7a6b176acf4c745d78bae1f967eccb777d19c36b1b3e7a0a217c0f55d65bcf93.css integrity="sha256-emsXas9MdF14uuH5Z+zLd30Zw2sbPnoKIXwPVdZbz5M="><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.af5d9722112bedac95702865c340bcd6286c4e9b2c15ce26b531ea1fba974cb8.js integrity="sha256-r12XIhEr7ayVcChlw0C81ihsTpssFc4mtTHqH7qXTLg=" data-copy=复制 data-copied=已复制></script><meta name=description content="
      
        
      
    "><link rel=canonical href=https://shaocheng.li/posts/2016/10/26/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://shaocheng.li/posts/2016/10/26/"><meta property="og:site_name" content="Shaocheng.Li"><meta property="og:title" content="Linux Wireless HowTo"><meta property="og:description" content="LiShaocheng's Blog"><meta property="og:locale" content="zh_Hans"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-10-26T08:00:00+08:00"><meta property="article:modified_time" content="2016-10-26T08:00:00+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Linux Wireless HowTo"><meta name=twitter:description content="LiShaocheng's Blog"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","articleSection":"文章","name":"Linux Wireless HowTo","headline":"Linux Wireless HowTo","inLanguage":"zh-Hans","url":"https:\/\/shaocheng.li\/posts\/2016\/10\/26\/","author":{"@type":"Person","name":"Shaocheng.Li"},"copyrightYear":"2016","dateCreated":"2016-10-26T08:00:00\u002b08:00","datePublished":"2016-10-26T08:00:00\u002b08:00","dateModified":"2016-10-26T08:00:00\u002b08:00","mainEntityOfPage":"true","wordCount":"1690"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://shaocheng.li/","name":"Shaocheng. Li","position":1},{"@type":"ListItem","item":"https://shaocheng.li/posts/","name":"文章","position":2},{"@type":"ListItem","name":"Linux Wireless How To","position":3}]}</script><meta name=author content="Shaocheng.Li"><link href=https://github.com/exbob rel=me></head><body class="m-auto flex h-screen max-w-7xl flex-col bg-neutral px-6 text-lg leading-7 text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="-translate-y-8 rounded-b-lg bg-primary-200 px-3 py-1 text-sm focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="pe-2 font-bold text-primary-600 dark:text-primary-400">&darr;</span>跳到主要内容</a></div><header class="py-6 font-semibold text-neutral-900 dark:text-neutral sm:py-10 print:hidden"><nav class="flex items-start justify-between sm:items-center"><div class="flex flex-row items-center"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>Shaocheng.Li</a></div><ul class="flex list-none flex-col text-end sm:flex-row"><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/posts/ title=文章><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">文章</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/projects/ title=做过的项目><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">项目</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/movies/ title=看过的电影><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">观影</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/exercise/ title=运动记录><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">运动</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/share/ title=好物分享><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">好物</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><button id=search-button-1 title="搜索 (/)">
<span class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"><span class="icon relative inline-block px-1 align-text-bottom"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></button></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><button id=appearance-switcher-1 type=button aria-label="appearance switcher">
<span class="group-dark:hover:text-primary-400 inline transition-colors group-hover:text-primary-600 dark:hidden" title=切换为深色模式><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg>
</span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span>
</span><span class="group-dark:hover:text-primary-400 hidden transition-colors group-hover:text-primary-600 dark:inline" title=切换为浅色模式><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg>
</span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></span></button></li></ul></nav></header><div class="relative flex grow flex-col"><main id=main-content class=grow><article><header class=max-w-prose><h1 class="mb-8 mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Linux Wireless HowTo</h1><div class="mb-10 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2016-10-26 08:00:00 +0800 +0800">2016 十月 26</time><span class="px-2 text-primary-500">&#183;</span><span>1690 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>8 分钟</span></div></div></header><section class="prose mt-0 flex max-w-full flex-col dark:prose-invert lg:flex-row"><div class="order-first px-0 lg:order-last lg:max-w-xs lg:ps-8"><div class="toc pe-5 lg:sticky lg:top-10 print:hidden"><details open class="-ms-5 mt-0 overflow-hidden rounded-lg ps-5"><summary class="block cursor-pointer bg-neutral-100 py-1 ps-5 text-lg font-semibold text-neutral-800 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">目录</summary><div class="border-s border-dotted border-neutral-300 py-2 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#1-硬件和驱动>1. 硬件和驱动</a></li><li><a href=#2-iw-工具>2. iw 工具</a></li><li><a href=#3-wpa_supplicant>3. wpa_supplicant</a></li><li><a href=#4-dhclient>4. dhclient</a></li><li><a href=#5-国别代码问题>5. 国别代码问题</a></li><li><a href=#参考>参考</a></li></ul></nav></div></details></div></div><div class="min-h-0 min-w-0 max-w-prose grow"><p>这里的无线（Wireless）指无线局域网，它的通用标准是 IEEE 802.11 协议，定义了数据链路层（MAC层）和物理层协议，工作载波的频率为 2.4GHz ，划分了 11 个频道，最新的协议已经有 5GHz 的工作频率。协议的演进方向是 802.11a->802.11b->802.11g->802.11n 。</p><p>而 802.11i 是 802.11 的无线安全协议，它的技术实现是 WPA 和 WPA2 ，都是开放秘钥认证方式，都属于 Wi-Fi 联盟，WPA2 是比 WPA 更高级的一种安全方式，RSN 是 WPA2 的别名。PSK 和 802.1X 是两种无线安全实现的方式，PSK 是个人级别的，而 802.1X 是企业级别的，较为复杂，但更安全。TKIP 和 CCMP 是两种数据加密算法，在 WPA 和 WPA2 中都可以使用。而 AES 是 CCMP 算法中的核心算法，且目前来看，是最可靠的加密算法。</p><p>Wi-Fi 是一个厂商联盟的标志，目的是建立一个统一的、基于 IEEE 802.11 协议的技术实现。可以简单把 Wi-Fi 设备理解为符合 IEEE 802.11 协议标准的设备。</p><p>Linux 系统中的无线网卡通常用到两种模式，一种是 Station 模式，也就是作为普通 Wi-Fi 设备去连接无线路由器；另一种是 AccessPoint（AP）模式，就是让无线网卡作为 Wi-Fi 热点，供其他 Wi-Fi 设备连接，这需要用到 hostapd ，可以参考 <a href=http://shaocheng.li/post/blog/2016-01-01 target=_blank rel=noreferrer>http://shaocheng.li/post/blog/2016-01-01</a>， 这里主要讲 Station 模式下无线网卡的操作方式。关于无线操作模式：<a href=http://shaocheng.li/post/blog/2012-10-27-wireless-oprating-mode target=_blank rel=noreferrer>http://shaocheng.li/post/blog/2012-10-27-wireless-oprating-mode</a> 。</p><h2 id=1-硬件和驱动 class="relative group">1. 硬件和驱动 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#1-%e7%a1%ac%e4%bb%b6%e5%92%8c%e9%a9%b1%e5%8a%a8 aria-label=锚点>#</a></span></h2><p>大部分无线网卡是 pci 设备，以 Intel 6205 为例，在 Fedora 21 中查看：</p><pre><code>[root@localhost ~]# lspci
00:00.0 Host bridge: Intel Corporation Atom Processor Z36xxx/Z37xxx Series SoC Transaction Register (rev 0c)
...
01:00.0 Network controller: Intel Corporation Centrino Advanced-N 6205 [Taylor Peak] (rev 34)
04:00.0 Ethernet controller: Intel Corporation 82574L Gigabit Network Connection
[root@localhost ~]# lspci -vk -s 01:00.0
01:00.0 Network controller: Intel Corporation Centrino Advanced-N 6205 [Taylor Peak] (rev 34)
        Subsystem: Intel Corporation Centrino Advanced-N 6205 AGN
        Flags: bus master, fast devsel, latency 0, IRQ 268
        Memory at 90700000 (64-bit, non-prefetchable) [size=8K]
        Capabilities: [c8] Power Management version 3
        Capabilities: [d0] MSI: Enable+ Count=1/1 Maskable- 64bit+
        Capabilities: [e0] Express Endpoint, MSI 00
        Capabilities: [100] Advanced Error Reporting
        Capabilities: [140] Device Serial Number 10-0b-a9-ff-ff-b4-99-00
        Kernel driver in use: iwlwifi
        Kernel modules: iwlwifi
</code></pre><p>可以看到它使用的驱动是 iwlwifi ，这是当前 Intel 无线芯片的通用驱动，针对不同的芯片需要不同的固件，固件名称的格式是 iwlwifi-*.ucode ，存放在 /lib/firmware/ 目录下。在这个页面可以查看支持的芯片和固件下载列表：<a href=https://wireless.wiki.kernel.org/en/users/drivers/iwlwifi target=_blank rel=noreferrer>https://wireless.wiki.kernel.org/en/users/drivers/iwlwifi</a> 。Linux 内核对无线设备的支持也是分层的结构，最上层面向用户空间的接口标准有两个，nl80211 和 wext ，nl80211 正在逐步替代 wext 。我们可以在 /sys/module/iwlwifi/parameters/ 目录下读取驱动的各项参数：</p><pre><code>/sys/module/iwlwifi/parameters# ls -l
total 0
-r--r--r-- 1 root root 4096 Nov 29 10:03 11n_disable
-r--r--r-- 1 root root 4096 Nov 29 10:03 amsdu_size_8K
-r--r--r-- 1 root root 4096 Nov 29 10:03 antenna_coupling
-r--r--r-- 1 root root 4096 Nov 29 10:03 bt_coex_active
-r--r--r-- 1 root root 4096 Nov 29 10:03 fw_restart
-r--r--r-- 1 root root 4096 Nov 29 10:03 led_mode
-r--r--r-- 1 root root 4096 Nov 29 10:03 nvm_file
-r--r--r-- 1 root root 4096 Nov 29 10:03 power_level
-r--r--r-- 1 root root 4096 Nov 29 10:03 power_save
-r--r--r-- 1 root root 4096 Nov 29 10:03 swcrypto
-r--r--r-- 1 root root 4096 Nov 29 10:03 wd_disable
</code></pre><p>如果要修改某个参数，需要在 /etc/modprobe.d/ 目录下新建一个 iwlwifi.conf 文件，然后添加选项，比如禁用 11n ：</p><pre><code>/etc/modprobe.d# cat iwlwifi.conf 
options iwlwifi 11n_disable=1
</code></pre><p>修改后重新加载驱动，或者重启，就可以在 /sys/module/iwlwifi/parameters 目录下验证该选项是否已经被修改：</p><pre><code>/sys/module/iwlwifi/parameters# cat 11n_disable 
1
</code></pre><p>驱动和固件加载成功后，就会出现设备文件：</p><pre><code>[root@localhost ~]# iw dev
phy#0
        Interface wlp1s0
                ifindex 3
                wdev 0x1
                addr 10:0b:a9:b4:99:00
                type managed
</code></pre><p>可以看到，这个无线设备的名称是 phy#0 ，接口名称是 wlp1s0 ，addr 段就是 mac 地址，当前的设备类型是 managed ，也就是 station 模式。用 <code>ifconfig -a</code> 也可以看到。</p><p>可以通过内核信息查询当前加载的固件版本：</p><pre tabindex=0><code>[root@localhost ~]# dmesg | grep iwlwifi
[27592.118803] iwlwifi 0000:03:00.0: Direct firmware load for iwlwifi-7265D-19.ucode failed with error -2
[27592.118837] iwlwifi 0000:03:00.0: Direct firmware load for iwlwifi-7265D-18.ucode failed with error -2
[27592.118890] iwlwifi 0000:03:00.0: Direct firmware load for iwlwifi-7265D-17.ucode failed with error -2
[27592.128638] iwlwifi 0000:03:00.0: loaded firmware version 16.242414.0 op_mode iwlmvm
</code></pre><h2 id=2-iw-工具 class="relative group">2. iw 工具 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#2-iw-%e5%b7%a5%e5%85%b7 aria-label=锚点>#</a></span></h2><p>iw 是一个管理无线设备的命令行工具，使用 nl80211 接口标准，支持所有最新被添加到 Linux 内核的无线网卡驱动。旧的 iwconfig 工具使用 wext 接口标准。</p><p>用 <code>iw list</code> 命令可以列出当前系统中所有无线设备的功能特性。如果要看指定网卡的特性，语法是 <code>iw devicename info</code> ：</p><pre><code>[root@localhost ~]# iw phy#0 info
Wiphy phy0
        max # scan SSIDs: 20
        max scan IEs length: 195 bytes
        Coverage class: 0 (up to 0m)
        Device supports RSN-IBSS.
        Supported Ciphers:
                * WEP40 (00-0f-ac:1)
                * WEP104 (00-0f-ac:5)
                * TKIP (00-0f-ac:2)
                * CCMP (00-0f-ac:4)
        Available Antennas: TX 0 RX 0
        Supported interface modes:
                 * IBSS
                 * managed
                 * AP
                 * AP/VLAN
                 * monitor
         ...
        Supported commands:
                 * new_interface
                 * set_interface
                 * new_key
                 * start_ap
                 * new_station
                 * new_mpath
         ...
        software interface modes (can always be added):
                 * AP/VLAN
                 * monitor
         ...
        Device supports TX status socket option.
        Device supports HT-IBSS.
        Device supports scan flush.
</code></pre><p>这个信息很长，首先看到最多可以扫描 20 个热点，支持的加密算法是 WEP 、TKIP、CCMP。在 Supported interface modes 段可以看到该网卡支持的模式，包括 AP ，在 software interface modes 可以看到该网卡支持软 AP 。在 Supported commands 段列出了该网卡支持的命令，这些都是 nl80211 接口提供的命令，可以在 Linux 内核的 nl80211.c 文件中看到。</p><p>运行 <code>iw dev wlp1s0 scan</code> 可以扫描 Wi-Fi 热点，前题是接口已经激活，可以用 <code>ifconfig wlp1s0 up</code> ，否则会失败：</p><pre><code>[root@localhost ~]# iw dev wlp1s0 scan                  
command failed: Network is down (-100)
</code></pre><p>以扫描到的一个热点为例：</p><pre><code>BSS f4:ec:38:30:bb:b8(on wlp1s0)
        TSF: 2459924068 usec (0d, 00:40:59)
        freq: 2437
        beacon interval: 100 TUs
        capability: ESS Privacy ShortPreamble ShortSlotTime (0x0431)
        signal: -51.00 dBm
        last seen: 1 ms ago
        SSID: TP-LINK_30BBB8
        Supported rates: 1.0* 2.0* 5.5* 11.0* 6.0 9.0 12.0 18.0 
        DS Parameter set: channel 6
        RSN:     * Version: 1
                 * Group cipher: CCMP
                 * Pairwise ciphers: CCMP
                 * Authentication suites: PSK
                 * Capabilities: 1-PTKSA-RC 1-GTKSA-RC (0x0000)
        WPA:     * Version: 1
                 * Group cipher: CCMP
                 * Pairwise ciphers: CCMP
                 * Authentication suites: PSK
        ERP: &lt;no flags&gt;
        ...
</code></pre><p>可以读到几个有用的信息，首先是信号强度 signal:-51.00 dBm ，热点的 SSID 是 TP-LINK_30BBB8 ，使用的频道是 6 ，认证方式是
WPA 和 RSN （即 WPA2），秘钥管理算法是 PSK ，加密算法是 CCMP 。</p><p>iw 支持手动连接无认证或者 WEP 认证的 Wi-Fi 热点，而不支持 WPA/WPA2 认证热点。如果要加入无认证的热点，执行 <code>iw wlp1s0 connect &lt;SSID></code> 。对于 WEP 认证的热点，执行 <code>iw wlp1s0 connect &lt;SSID> [key 0:abcde d:1:6162636465]</code> 。连接成功后，可以设置静态 IP ，也可以用 dhclient 动态获取 IP 和 DNS 。我们很少用 iw 来连接 Wi-Fi ，通常是用 wpa_supplicant 。</p><p>还有一个在调试时有用的命令 <code>iw event</code> ，它可以监听 Wi-Fi 连接过程中的所有事件。当启动 wpa_supplicant 去连接一个热点时，可以开启该命令，它会显示完整的连接过程，包括扫描、协商、验证、连接。加一个 -f 选项可以显示连接过程发送的帧，加 -t 选项可以显示每个步骤的时间：</p><pre><code>[root@localhost ~]# iw event -t
1478053617.986731: wlp1s0 (phy #0): scan started
1478053619.947956: wlp1s0 (phy #0): scan finished: 2412 2417 2422 2427 2432 2437 2442 2447 2452 2457 2462 2467 2472 5180 5200 5220 5240 5260 5280 5300 5320 5745 5765 5785 5805 5825, &quot;&quot;
1478053619.977751: wlp1s0: new station f4:ec:38:30:bb:b8
1478053619.988617: wlp1s0 (phy #0): auth f4:ec:38:30:bb:b8 -&gt; 10:0b:a9:b4:99:00 status: 0: Successful
1478053620.043766: wlp1s0 (phy #0): assoc f4:ec:38:30:bb:b8 -&gt; 10:0b:a9:b4:99:00 status: 0: Successful
1478053620.043992: wlp1s0 (phy #0): connected to f4:ec:38:30:bb:b8
</code></pre><p>查看连接状态：</p><pre><code>[root@localhost ~]# iw wlp1s0 link    
Not connected.
[root@localhost ~]# iw wlp1s0 link
Connected to f4:ec:38:30:bb:b8 (on wlp1s0)
        SSID: TP-LINK_30BBB8
        freq: 2437
        RX: 6256 bytes (46 packets)
        TX: 1435 bytes (15 packets)
        signal: -59 dBm
        tx bitrate: 1.0 MBit/s
        bss flags:      short-preamble short-slot-time
        dtim period:    1
        beacon int:     100
</code></pre><p>SSID 字段表示当前连接的热点名称。signal 字段表示当前连接热点的信号强度，它是个负数，越接近 0 ，表示信号越好，小于 -113 就基本没信号了。</p><p>查看当前无线设备的使用情况，包括进出流量等信息：</p><pre><code>[root@localhost ~]# iw dev wlp1s0 station dump   
Station f4:ec:38:30:bb:b8 (on wlp1s0)
        inactive time:  175 ms
        rx bytes:       4635
        rx packets:     31
        tx bytes:       1095
        tx packets:     11
        tx retries:     49
        tx failed:      2
        signal:         -68 dBm
        signal avg:     -64 dBm
        tx bitrate:     1.0 MBit/s
        rx bitrate:     54.0 MBit/s MCS 3 40MHz
        authorized:     yes
        authenticated:  yes
        preamble:       long
        WMM/WME:        yes
        MFP:            no
        TDLS peer:      no
</code></pre><p>iw 还有其他选项，可以执行 <code>iw help</code> 查看。</p><h2 id=3-wpa_supplicant class="relative group">3. wpa_supplicant <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#3-wpa_supplicant aria-label=锚点>#</a></span></h2><p>wpa_supplicant 是一个命令行式的 Wi-Fi 访问客户端程序，支持 WEP、WPA/WPA2 认证方式，在 Linux 中用于自动连接 Wi-Fi 热点，支持断线后自动重连。同时支持 nl80211 和 wext 两种驱动接口。</p><p>常用选项：</p><ul><li>-B ：让 wpa_supplicant 运行在后台，在 -i 选项前设置。</li><li>-c filename ：配置文件的路径，在 -i 选项前设置。</li><li>-D ：设置使用的驱动，可选 nl80211 和 wext 等，在 -i 选项前设置。</li><li>-i interface ：监听的无线设备接口名称，这里可以设为 wlp1s0 。</li><li>-d ：增加调试信息，-dd 可以显示更多。</li><li>-t ：在调试信息中加上时间戳。</li><li>-f filename ：日志文件的路径。</li><li>-P filename ：PID 文件的路径。</li><li>-q ：减少调试信息，-qq 可以显示的更少。</li><li>-u ：使能 DBus 控制接口。</li><li>-N ：如果有多个无线设备，就用 -N 分隔，之后继续设置下一个。例如 <code>wpa_supplicant -c wpa1.conf -i wlan0 -D hostap -N -c wpa2.conf -i ath0 -D madwifi</code></li></ul><p>配置文件通常是 /etc/wpa_supplicant/wpa_supplicant.conf ，可以在文件内设置多个 Wi-Fi 热点的连接信息，wpa_supplicant 启动后会自动选择一个最好的网络，依据是认证方式（ WPA/WPA2 优先）和信号强度。如果完整安装了 wpa_supplicant ，在 /usr/share/doc/wpa_supplicant/ 目录下会有一个 wpa_supplicant.conf 文件，里面有各种情况的详细配置和说明。说几个常用的全局配置选项：</p><ul><li>ctrl_interface=filename ：设置控制接口的路径。如果设置了该参数，wpa_supplicant 会打开一个控制接口，供外部程序管理 wpa_supplicant 。推荐设置为 /var/run/wpa_supplicant ，wpa_supplicant 会在此目录下生成 socket ，用于监听外部程序状态的请求。</li><li>ap_scan ：通常设为 1 。由 wpa_supplicant 启动扫描和 AP 选择，如果没有找到与配置文件中相匹配的 AP ，则初始化一个新网络（如果有配置）。另外可选 0 或 2 。</li></ul><p>每个 Wi-Fi 热点的连接信息都配置在一个 network 段中，几个常用的选项：</p><ul><li>key_mgmt ：秘钥管理算法，对于 WPA/WPA2 ，根据 Wi-Fi 热点的配置可选 WPA-PSK 和 WPA-EAP 。</li><li>ssid ：热点的 ssid 。</li><li>psk ：对于 WPA/WPA2 ，密码不能设为明码，需要用 wpa_passphrase 命令生成加密后的 64 位十六进制数，语法是 <code>wpa_passphrase SSID password</code> 。</li></ul><p>假如现在要连接一个 WPA/WPA2 认证的无线路由器，配置文件如下：</p><pre><code>[root@localhost ~]# wpa_passphrase TP-LINK_30BBB8 123456789 
network={
    ssid=&quot;TP-LINK_30BBB8&quot;
    #psk=&quot;123456789&quot;
    psk=b9ea0d09776bd4f4d8099b78ab91d924b97366562d620161a1b4ffb1ac99ae33
}
[root@localhost ~]# cat /etc/wpa_supplicant/wpa_supplicant.conf
ctrl_interface=/var/run/wpa_supplicant
ap_scan=1
network={
        ssid=&quot;TP-LINK_30BBB8&quot;
        key_mgmt=WPA-PSK
        #psk=&quot;123456789&quot;
        psk=b9ea0d09776bd4f4d8099b78ab91d924b97366562d620161a1b4ffb1ac99ae33
}
</code></pre><p>对于无许认证的热点，只设置 ssid 即可 ：</p><pre><code>network={
    ssid=&quot;MYSSID&quot;
    key_mgmt=NONE
}
</code></pre><p>然后执行 wpa_supplicant 开始连接：</p><pre><code>[root@localhost ~]# wpa_supplicant -B -Dnl80211 -u -iwlp1s0 -c /etc/wpa_supplicant/wpa_supplicant.conf -f /var/log/wpa_supplicant.log -P /var/run/wpa_supplicant.pid 
</code></pre><p>连接过程可以查看 log 文件，连接成功后可以设置静态 IP ，也可以用 dhclient 获得动态 IP 。</p><h2 id=4-dhclient class="relative group">4. dhclient <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#4-dhclient aria-label=锚点>#</a></span></h2><p>DHCP 协议是一种集中管理和自动分配 IP 地址的通信协议，使用 UDP 协议工作。DHCP 使用了租约的概念，即获得的 IP 地址的有效期。一次典型的 DHCP 工作周期分为发现、提供、请求、确认，如图：</p><p><figure><img src=./pics_1.jpg alt class="mx-auto my-0 rounded-md"></figure></p><p>不再租用 IP 后，客户端应该向 DHCP 服务器发送一个请求以释放 DHCP 资源，并注销其IP地址。详情可以参考<a href=https://zh.wikipedia.org/wiki/%E5%8A%A8%E6%80%81%E4%B8%BB%E6%9C%BA%E8%AE%BE%E7%BD%AE%E5%8D%8F%E8%AE%AE target=_blank rel=noreferrer>动态主机设置协议</a></p><p>dhclient 是一个 DHCP 客户端程序，用于从 DHCP 服务器获取动态 IP ，默认支持 IPV4 ，也支持 IPV6 。成功获得 IP 后，程序会驻留在后台。常用的选项有：</p><ul><li>-lf <lease-file>：lease 文件的路径，默认是 /var/lib/dhclient/dhclient.leases ，是成功获取 IP 后的数据库。</li><li>-pf <pid-file>：PID 文件的路径，默认是 /var/run/dhclient.pid 。</li><li>-cf <config-file>：配置文件的路径. 默认是 /etc/dhcp/dhclient.conf 。</li><li>-sf <script-file>：网络配置脚本文件的路径。默认是 /sbin/dhclient-script ，成功获取 IP 后会执行该脚本，主要作用是配置 IP 、DNS、和默认路由，还会调用 /etc/dhcp/dhclient.d/ 下的用户自定义脚本。</li><li>-q ：保持安静，不输出任何信息。</li><li>-timeout <time>：超时时间，超过这个时间而无法获得 IP 即退出。</li><li>-r ：告诉 dhclient 释放获取的 IP ，释放后，后台的 dhclient 会退出。</li><li>-d ：让 dhclient 在前台运行。</li></ul><p>配置文件默认是 /etc/dhcp/dhclient.conf，同目录下还有一个名为 dhclient.d 的文件夹，可以在下面放一些脚本，供 dhclient-script 调用，执行一下获取 IP 后的动作。如果安装了完整的程序，在 /usr/share/doc/dhclient 目录下会有配置文件的例子和 dhclient.d 下脚本文件的说明。</p><p>针对 wlp1s0 这个接口写一个简单的配置文件：</p><pre><code>timeout 60;
retry 60;
reboot 10;
select-timeout 5;
initial-interval 2;
reject 192.33.137.209;
interface &quot;wlp1s0&quot; {
    send host-name “my_pc&quot;;
    send dhcp-lease-time 3600;
    request subnet-mask, broadcast-address, time-offset, routers,domain-search, domain-name, domain-name-servers, host-name;
    require subnet-mask, domain-name-servers,host-name;
}
</code></pre><p>解释一下这些配置选项：</p><ul><li>timeout ：超时时间，这里设置是 60 秒。从尝试与 DHCP server 联系开始，超过这个时间还没有获得 IP ，就结束这次协商，在重试间隔后再重启协商。</li><li>retry ：重试间隔，一次与 DHCP server 协商失败后，经过这个时间后重启协商，默认是五分钟。</li><li>reboot ：当 dhclient 启动后，它会首先尝试请求上一次连接该网络时获得的 IP ，如果失败，则经过这个时间后在尝试请求新 IP ，默认是十秒。</li><li>select-timeout ：如果有多个 DHCP server 为该网络提供服务，client 可能获得多个 IP 提议，而这些提议有先后顺序，client 会在 select-timeout 时间内接收提议，然后选择最优的（比如上一次获得的 IP ），超过这个时间，就停止接收新提议。默认是零秒，就是直接采用第一个接收到的提议。</li><li>initial-interval ：第一次尝试到达服务器和第二次尝试到达服务器的间隔。</li><li>reject ：拒绝来自某些 DHCP server 的提议。可以指定某个 IP ，也可以通过子网掩码指定拒绝某个网段，多个 IP 用逗号分隔，例如：<code>reject 192.168.0.0/16, 10.0.0.5;</code> 。</li></ul><p>设置完全局选项，就可以对网口进行单独设置，这些选项可以在 dhcp-options 的 man 手册中查找。一个配置文件可以为多个网口配置不同的行为，语法是 <code>interface "name" { declarations ... }</code> ，name 就是网口名称，花括号内为它的配置选项：</p><ul><li>send host-name ：向服务器发送本机的名称。</li><li>send dhcp-lease-time ：告诉服务器请求的 IP 租期，这里设置了 3600 秒。</li><li>request ：请求服务器向客户端发送指定选项的值，通常不用设置，缺省已经请求了很多必要选项。</li><li>require ：列出了必须向服务器发送的选项，以便接收要约，要发送的值用 send 语句设置。没有缺省值。</li></ul><p>有了配置文件后，执行 <code>dhclient</code> 即可。与 DHCP server 协商成功后，会将获取的 IP 等信息保存到 dhclient.leases 文件，这是 DHCP client 租赁数据库，如果有多条数据，最后一天有效。</p><pre><code>[root@localhost ~]# cat /var/lib/dhclient/dhclient.leases 
default-duid &quot;\000\001\000\001\037\234\226n\020\013\251\264\231\000&quot;;
lease {
  interface &quot;wlp1s0&quot;;
  fixed-address 192.168.1.105;
  option subnet-mask 255.255.255.0;
  option routers 192.168.1.1;
  option dhcp-lease-time 7200;
  option dhcp-message-type 5;
  option domain-name-servers 192.168.1.1;
  option dhcp-server-identifier 192.168.1.1;
  renew 1 2016/10/24 08:59:57;
  rebind 1 2016/10/24 09:51:49;
  expire 1 2016/10/24 10:06:49;
}
</code></pre><p>然后 dhclient 会调用 dhclient-script 文件，它的作用修改网口 IP 、修改默认路由、替换 /etc/resolv.conf 文件，还会调用 /etc/dhcp/dhclient.d/ 下的用户自定义脚本，详情可以查看 dhclient-script 的 man 手册。</p><p>如果要是否释放 IP ，执行 <code>dhclient -r</code> 。</p><p>最后补充一点，在目前的 Linux 发行版中，已经有集成化的网卡管理工具，比如 NetworkManager ，可以统一的管理以太网、Wi-Fi、3G等网卡设备，简化了很多步骤，比较方便，当然底层还是调用这些基本的程序。</p><h2 id=5-国别代码问题 class="relative group">5. 国别代码问题 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#5-%e5%9b%bd%e5%88%ab%e4%bb%a3%e7%a0%81%e9%97%ae%e9%a2%98 aria-label=锚点>#</a></span></h2><p>不同的国家和地区对 Wi-Fi 的合法频段有不同的要求，Wi-Fi 模块都支持设置国别代码，使模块使用合法的频段。可以通过 iw 命令读取当前模块设置的国别代码与合法频段：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>root@localhost:~# iw reg get
</span></span><span class=line><span class=cl>country CN: DFS-FCC
</span></span><span class=line><span class=cl>	<span class=o>(</span><span class=m>2402</span> - <span class=m>2482</span> @ 40<span class=o>)</span>, <span class=o>(</span>N/A, 20<span class=o>)</span>, <span class=o>(</span>N/A<span class=o>)</span>
</span></span><span class=line><span class=cl>	<span class=o>(</span><span class=m>5170</span> - <span class=m>5250</span> @ 80<span class=o>)</span>, <span class=o>(</span>N/A, 23<span class=o>)</span>, <span class=o>(</span>N/A<span class=o>)</span>
</span></span><span class=line><span class=cl>	<span class=o>(</span><span class=m>5250</span> - <span class=m>5330</span> @ 80<span class=o>)</span>, <span class=o>(</span>N/A, 23<span class=o>)</span>, <span class=o>(</span><span class=m>0</span> ms<span class=o>)</span>, DFS
</span></span><span class=line><span class=cl>	<span class=o>(</span><span class=m>5735</span> - <span class=m>5835</span> @ 80<span class=o>)</span>, <span class=o>(</span>N/A, 30<span class=o>)</span>, <span class=o>(</span>N/A<span class=o>)</span>
</span></span><span class=line><span class=cl>	<span class=o>(</span><span class=m>57240</span> - <span class=m>59400</span> @ 2160<span class=o>)</span>, <span class=o>(</span>N/A, 28<span class=o>)</span>, <span class=o>(</span>N/A<span class=o>)</span>
</span></span><span class=line><span class=cl>	<span class=o>(</span><span class=m>59400</span> - <span class=m>63720</span> @ 2160<span class=o>)</span>, <span class=o>(</span>N/A, 44<span class=o>)</span>, <span class=o>(</span>N/A<span class=o>)</span>
</span></span><span class=line><span class=cl>	<span class=o>(</span><span class=m>63720</span> - <span class=m>65880</span> @ 2160<span class=o>)</span>, <span class=o>(</span>N/A, 28<span class=o>)</span>, <span class=o>(</span>N/A<span class=o>)</span>
</span></span></code></pre></div><p>在 Linux 系统里通常是通过配置文件这种相应的驱动参数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>root@localhost:~# cat /etc/default/crda
</span></span><span class=line><span class=cl><span class=c1># Set REGDOMAIN to a ISO/IEC 3166-1 alpha2 country code so that iw(8) may set</span>
</span></span><span class=line><span class=cl><span class=c1># the initial regulatory domain setting for IEEE 802.11 devices which operate</span>
</span></span><span class=line><span class=cl><span class=c1># on this system.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Governments assert the right to regulate usage of radio spectrum within</span>
</span></span><span class=line><span class=cl><span class=c1># their respective territories so make sure you select a ISO/IEC 3166-1 alpha2</span>
</span></span><span class=line><span class=cl><span class=c1># country code suitable for your location or you may infringe on local</span>
</span></span><span class=line><span class=cl><span class=c1># legislature. See `/usr/share/zoneinfo/zone.tab&#39; for a table of timezone</span>
</span></span><span class=line><span class=cl><span class=c1># descriptions containing ISO/IEC 3166-1 alpha2 country codes.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>REGDOMAIN</span><span class=o>=</span>CN
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@localhost:~# cat /etc/modprobe.d/iwlwifi.conf
</span></span><span class=line><span class=cl><span class=c1># /etc/modprobe.d/iwlwifi.conf</span>
</span></span><span class=line><span class=cl><span class=c1># iwlwifi will dyamically load either iwldvm or iwlmvm depending on the</span>
</span></span><span class=line><span class=cl><span class=c1># microcode file installed on the system.  When removing iwlwifi, first</span>
</span></span><span class=line><span class=cl><span class=c1># remove the iwl?vm module and then iwlwifi.</span>
</span></span><span class=line><span class=cl>remove iwlwifi <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=o>(</span>/sbin/lsmod <span class=p>|</span> grep -o -e ^iwlmvm -e ^iwldvm -e ^iwlwifi <span class=p>|</span> xargs /sbin/rmmod<span class=o>)</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=o>&amp;&amp;</span> /sbin/modprobe -r mac80211
</span></span><span class=line><span class=cl>options iwlwifi <span class=nv>lar_disable</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@localhost:~# cat /etc/modprobe.d/cfg80211.conf
</span></span><span class=line><span class=cl>options cfg80211 <span class=nv>ieee80211_regdom</span><span class=o>=</span><span class=s2>&#34;CN&#34;</span>
</span></span></code></pre></div><h2 id=参考 class="relative group">参考 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%8f%82%e8%80%83 aria-label=锚点>#</a></span></h2><ul><li><a href=https://wireless.wiki.kernel.org target=_blank rel=noreferrer>https://wireless.wiki.kernel.org</a></li><li>man 手册</li></ul></div></section><footer class="max-w-prose pt-8 print:hidden"><div class=flex><picture class="!mb-0 !mt-0 me-4 w-24 h-auto rounded-full"><img width=568 height=568 class="!mb-0 !mt-0 me-4 w-24 h-auto rounded-full" alt=Shaocheng.Li loading=lazy decoding=async src=/img/author.png></picture><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">作者</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Shaocheng.Li</div><div class="text-sm text-neutral-700 dark:text-neutral-400">A Linux software engineer.</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://github.com/exbob target=_blank aria-label=Github rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></a></div></div></div></div><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="group flex" href=/posts/2016/10/25/><span class="me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&larr;</span><span class="ltr:hidden rtl:inline">&rarr;</span></span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Linux 3G Module HowTo</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2016-10-25 08:00:00 +0800 +0800">2016 十月 25</time>
</span></span></a></span><span><a class="group flex text-right" href=/posts/2016/12/24/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">推荐一款 Markdown 编辑器</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2016-12-24 08:00:00 +0800 +0800">2016 十二月 24</time>
</span></span><span class="ms-2 text-neutral-700 transition-transform group-hover:-translate-x-[-2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&rarr;</span><span class="ltr:hidden rtl:inline">&larr;</span></span></a></span></div></div></footer></article></main><div class="pointer-events-none absolute bottom-0 end-0 top-[100vh] w-12" id=to-top hidden=true><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label=回到顶部 title=回到顶部>&uarr;</a></div><footer class="py-10 print:hidden"><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
Shaocheng.Li</p><p class="text-xs text-neutral-500 dark:text-neutral-400">由 <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://github.com/jpanther/congo target=_blank rel="noopener noreferrer">Congo</a> 强力驱动</p></div><div class="flex flex-row items-center"></div></div></footer><div id=search-wrapper class="invisible fixed inset-0 z-50 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://shaocheng.li/><div id=search-modal class="top-20 mx-auto flex min-h-0 w-full max-w-3xl flex-col rounded-md border border-neutral-200 bg-neutral shadow-lg dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex flex-none items-center justify-between px-2"><form class="flex min-w-0 flex-auto items-center"><div class="flex h-8 w-8 items-center justify-center text-neutral-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="mx-1 flex h-12 flex-auto appearance-none bg-transparent focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=搜索 tabindex=0></form><button id=close-search-button class="flex h-8 w-8 items-center justify-center text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="关闭 (Esc)">
<span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto overflow-auto px-2"><ul id=search-results></ul></section></div></div></div></body></html>