<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="Shaocheng.Li"><meta name=description content="原文：
The Vim/Cscope tutorial
http://cscope.sourceforge.net/cscope_vim_tutorial.html
Translated by Bob
2012-4-27
Email：gexbob@gmail.com
Blog：http://shaocheng.li
Cscope 是一个非常方便的工具, 它会为你的编辑器（即 Vim ）带来很好的舒适性. 幸运的是, Cscope 已经被 Vim 在内部集成.
这个教程向你介绍了 Vim 内建的 Cscope 支持，以及一套让搜索更方便的方法.
假设你知道使用 vi 风格编辑器的基本知识, 但是不需要任何关于Vim的特定知识 (会简单介绍一些用得到的 Vim 特有功能——如多窗口). 你也无需知道任何关于Cscope的知识: 我们会逐步介绍一些基本的东西.
简而言之，Vim 的 Cscope 支持很像你用过的 Vim 的 ctags 功能。但是因为 Cscope 的搜索类型比 ctags 更多，所以会有些不同。
这是一个实践教程, 所以要启动一个 shell , 然后跟着下面的步骤做:
1.
如果你的电脑还没有Cscope，先下载并安装。理想状态下, 你的 Vim 应该是 6.x 版本, 但是用 Vim 5 以上的版本都可以获得大部分功能 (无法使用垂直分割, 但是通过修改相关文件可以使用水平分割).
注意: 如果你的 Vim 版本在编译时没有指定 &amp;lsquo;&amp;ndash;enable-cscope&amp;rsquo; 选项, 你需要重新编译和配置 Vim 。 大部分随 Linux 发行版安装的 Vim 二进制文件都使能了 Cscope 插件。"><meta name=keywords content><meta name=robots content="noodp"><meta name=theme-color content="#252627"><link rel=canonical href=https://shaocheng.li/posts/2012/04/29/><title>Vim/Cscope 教程 :: Shaocheng.Li — Hello Friends</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=https://shaocheng.li/main.min.e9b3dfcc5ffe9d55eb281ecaf47cf6179d26eec497e087299934d581c987aa0b.css><link rel=stylesheet type=text/css href=https://shaocheng.li/css/custom.css><link rel=apple-touch-icon sizes=180x180 href=https://shaocheng.li/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://shaocheng.li/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://shaocheng.li/favicon-16x16.png><link rel=manifest href=https://shaocheng.li/site.webmanifest><link rel=mask-icon href=https://shaocheng.li/safari-pinned-tab.svg color=#252627><link rel="shortcut icon" href=https://shaocheng.li/favicon.ico><meta name=msapplication-TileColor content="#252627"><meta name=theme-color content="#252627"><meta itemprop=name content="Vim/Cscope 教程"><meta itemprop=description content="原文：
The Vim/Cscope tutorial
http://cscope.sourceforge.net/cscope_vim_tutorial.html
Translated by Bob
2012-4-27
Email：gexbob@gmail.com
Blog：http://shaocheng.li
Cscope 是一个非常方便的工具, 它会为你的编辑器（即 Vim ）带来很好的舒适性. 幸运的是, Cscope 已经被 Vim 在内部集成.
这个教程向你介绍了 Vim 内建的 Cscope 支持，以及一套让搜索更方便的方法.
假设你知道使用 vi 风格编辑器的基本知识, 但是不需要任何关于Vim的特定知识 (会简单介绍一些用得到的 Vim 特有功能——如多窗口). 你也无需知道任何关于Cscope的知识: 我们会逐步介绍一些基本的东西.
简而言之，Vim 的 Cscope 支持很像你用过的 Vim 的 ctags 功能。但是因为 Cscope 的搜索类型比 ctags 更多，所以会有些不同。
这是一个实践教程, 所以要启动一个 shell , 然后跟着下面的步骤做:
1.
如果你的电脑还没有Cscope，先下载并安装。理想状态下, 你的 Vim 应该是 6.x 版本, 但是用 Vim 5 以上的版本都可以获得大部分功能 (无法使用垂直分割, 但是通过修改相关文件可以使用水平分割).
注意: 如果你的 Vim 版本在编译时没有指定 &lsquo;&ndash;enable-cscope&rsquo; 选项, 你需要重新编译和配置 Vim 。 大部分随 Linux 发行版安装的 Vim 二进制文件都使能了 Cscope 插件。"><meta itemprop=datePublished content="2012-04-29T08:00:00&#43;08:00"><meta itemprop=dateModified content="2012-04-29T08:00:00&#43;08:00"><meta itemprop=wordCount content="497"><meta itemprop=keywords content><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://shaocheng.li"><meta name=twitter:title content="Vim/Cscope 教程"><meta name=twitter:description content="原文：
The Vim/Cscope tutorial
http://cscope.sourceforge.net/cscope_vim_tutorial.html
Translated by Bob
2012-4-27
Email：gexbob@gmail.com
Blog：http://shaocheng.li
Cscope 是一个非常方便的工具, 它会为你的编辑器（即 Vim ）带来很好的舒适性. 幸运的是, Cscope 已经被 Vim 在内部集成.
这个教程向你介绍了 Vim 内建的 Cscope 支持，以及一套让搜索更方便的方法.
假设你知道使用 vi 风格编辑器的基本知识, 但是不需要任何关于Vim的特定知识 (会简单介绍一些用得到的 Vim 特有功能——如多窗口). 你也无需知道任何关于Cscope的知识: 我们会逐步介绍一些基本的东西.
简而言之，Vim 的 Cscope 支持很像你用过的 Vim 的 ctags 功能。但是因为 Cscope 的搜索类型比 ctags 更多，所以会有些不同。
这是一个实践教程, 所以要启动一个 shell , 然后跟着下面的步骤做:
1.
如果你的电脑还没有Cscope，先下载并安装。理想状态下, 你的 Vim 应该是 6.x 版本, 但是用 Vim 5 以上的版本都可以获得大部分功能 (无法使用垂直分割, 但是通过修改相关文件可以使用水平分割).
注意: 如果你的 Vim 版本在编译时没有指定 &lsquo;&ndash;enable-cscope&rsquo; 选项, 你需要重新编译和配置 Vim 。 大部分随 Linux 发行版安装的 Vim 二进制文件都使能了 Cscope 插件。"><meta property="article:published_time" content="2012-04-29 08:00:00 &#43;0800 &#43;0800"></head><body><div class=container><header class=header><span class=header__inner><a href=https://shaocheng.li/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>$ cd /home/</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://shaocheng.li/about/>About</a></li><li><a href=https://shaocheng.li/posts/>Posts</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>3 minutes</p></div><article><h1 class=post-title><a href=https://shaocheng.li/posts/2012/04/29/>Vim/Cscope 教程</a></h1><div class=post-content><p>原文：</p><p>The Vim/Cscope tutorial</p><p><a href=http://cscope.sourceforge.net/cscope_vim_tutorial.html target=_blank>http://cscope.sourceforge.net/cscope_vim_tutorial.html</a></p><p>Translated by Bob</p><p>2012-4-27</p><p>Email：<a href=mailto:gexbob@gmail.com target=_blank>gexbob@gmail.com</a></p><p>Blog：<a href=http://shaocheng.li target=_blank>http://shaocheng.li</a></p><hr><p>Cscope 是一个非常方便的工具, 它会为你的编辑器（即 Vim ）带来很好的舒适性. 幸运的是, Cscope 已经被 Vim 在内部集成.</p><p>这个教程向你介绍了 Vim 内建的 Cscope 支持，以及一套让搜索更方便的方法.</p><p>假设你知道使用 vi 风格编辑器的基本知识, 但是不需要任何关于Vim的特定知识 (会简单介绍一些用得到的 Vim 特有功能——如多窗口). 你也无需知道任何关于Cscope的知识: 我们会逐步介绍一些基本的东西.</p><p>简而言之，Vim 的 Cscope 支持很像你用过的 Vim 的 ctags 功能。但是因为 Cscope 的搜索类型比 ctags 更多，所以会有些不同。</p><p>这是一个实践教程, 所以要启动一个 shell , 然后跟着下面的步骤做:</p><p>1.</p><p>如果你的电脑还没有Cscope，先下载并安装。理想状态下, 你的 Vim 应该是 6.x 版本, 但是用 Vim 5 以上的版本都可以获得大部分功能 (无法使用垂直分割, 但是通过修改相关文件可以使用水平分割).</p><p>注意: 如果你的 Vim 版本在编译时没有指定 &lsquo;&ndash;enable-cscope&rsquo; 选项, 你需要重新编译和配置 Vim 。 大部分随 Linux 发行版安装的 Vim 二进制文件都使能了 Cscope 插件。</p><p>2.</p><p>下载 cscope_maps.vim 文件, 让 Vim 在启动时读取它. 如果你用的是 Vim 6.x, 把它复制到 $HOME/.vim/plugin 目录下即可 (或者其他插件子目录). 如果你用的是 Vim 5.x, 只能把 cscope_maps 文件的内容复制到 $HOME/.vimrc 文件中, 或者黏贴 &ldquo;source cscope_maps.vim&rdquo; 一行到 .vimrc 文件.</p><p>3.</p><p>进入一个有C代码文件的目录, 执行 &lsquo;cscope -R&rsquo; ( &lsquo;-R&rsquo; 会让 Cscope 遍历所有子目录, 否则只会检测当前目录). 由于没有使用 &lsquo;-b&rsquo; 选项 (它告诉 Cscope 只建立数据库后就退出), Cscope 会打开一个基于 curses 的 GUI 界面. 在这里尝试一些搜索 (提示: 使用方向键可以在搜索类型之间移动, 用 &lsquo;tab&rsquo; 键来在搜索类型和搜索结果之间做出选择). 在搜索结果的左边敲入数字, Cscope 就会在 Vim 中打开它的位置. (除非你把 EDITOR 环境变量设为了 Vim 之外的东西). 关闭 Vim, 就会返回到离开 Cscope GUI 时的位置. 有趣。</p><p>Cscope 接口有个大问题； 每次要执行新的搜索时都要关闭 Vim. 这就是 Vim 插件. 用 CTRL-D 关闭 Cscope.</p><p>4.</p><p>启动 Vim. 如果你愿意, 可以在启动时带一个C语言的标识符 (入: &lsquo;vim -t main&rsquo;), 然后就会跳到代码中该标识符定义的地方.</p><p>5.</p><p>把光标移到一个在程序中多次使用的标识符上. 键入 &ldquo;CTRL-\ s&rdquo; (先敲CTRL-\, 然后敲 &rsquo;s&rsquo;) , 应该会在 Vim 窗口的底部看到一个菜单，显示了程序中所有用到这个标识符的地方. 选择其中的一个然后点回车, 就会跳到那里. 类似 ctags, 可以点击 &ldquo;CTRL-t&rdquo; 调回搜索之前的位置 (也可以多搜索几个，然后用 CTRL-t 依次释放).</p><p>助记符: &lsquo;\&lsquo;键在&rsquo;]&lsquo;键的右边, 用于 ctags 搜索.</p><p>6.</p><p>尝试同样的搜索, 但是这次用 &ldquo;CTRL-spacebar s&rdquo; 组合键. 这一次，Vim 窗口会水平分割为两个, Cscope 的搜索结果将在新的窗口上显示.[如果你从来没用过 Vim 的多窗口: 用 &lsquo;CTRL-W w&rsquo; (或 CTRL-W 和方向键, 或 CTRL-W 和 h/j/k/l )在窗口之间移动, 用 &lsquo;CTRL-W c&rsquo; (或 &lsquo;:q&rsquo;)关闭一个窗口, 用 &lsquo;CTRL-W o&rsquo;只显示当前窗口, 用 &lsquo;CTRL-W s&rsquo; (或 &lsquo;CTRL-W v&rsquo; 垂直分割)将窗口分割为两个, 用 &lsquo;:spl[it] filename]&rsquo; 在分割的新窗口打开文件。</p><p>Mnemonic: 在两个分割的窗口之间会有一条空白的间隔.</p><p>7.</p><p>现在用 &ldquo;CTRL-spacebar CTRL-spacebar s&rdquo;(只需按住CTRL连按两次空格)进行同样的搜索. 如果你无法快速的按键, 就打开 cscope_maps.vim 脚本，将 Vim 的超时设置改为注释 [事实上，我通常关闭 Vim 的超时]. 这一次 Vim 的窗口会被垂直分割 (注意: 在 Vim 5.x 上是无法实现的).</p><p>8.</p><p>到目前为止，我们只用到了&rsquo;cscope_maps.vim&rsquo;的热键,所有的搜索都与 Vim 中的光标有关. Cscope 搜索有一个老办法 (用 Vim 的内建 Cscope), 用 &ldquo;:cscope find symbol foo&rdquo;命令 (或者简单点，&rdquo;:cs f s foo&rdquo;). 对于可水平分割的版本,可以用&rdquo;:scscope&rdquo; (或&rdquo;:scs&rdquo;) . 如果要搜索的词就在光标下，用热键更简单, 命令行的方式可以让你搜索任何标识符，所以要根据实际情况选择.</p><p>9.</p><p>到目前为止，我们只用了一种搜索方法：‘s&rsquo;，查找标识符的使用情况。试一下 Cscope 的其他用法: &lsquo;g&rsquo; ，查找全局定义的标识符；&rsquo;c&rsquo;，查找一个函数的所有调用；&rsquo;f&rsquo; 打开光标所指的文件名 (注意: 因为 Cscope 默认从 /usr/include 查找头文件, 可以用这个功能打开大部分标准头文件). 这些都是我最常用的, 但是还有其他的 (在 cscope_maps.vim 文件可以找到所有的用法，也可以看 Cscope 的 man 手册).</p><p>10.</p><p>虽然 Cscope 最初只支持 C 语言, 实际上它是个非常灵活的工具，可以支持类似 C++ 和 Java 这样的语言. 你可以把它想象成一个通用的&rsquo;grep&rsquo;数据库, 它的作用是分析函数调用和变量定义等类似的结构. Cscope 默认只能解析当前目录(用‘-R’选项可以包括子目录)下的 C, lex, 和 yacc 文件 (.c, .h, .l, .y) , 目前还无法修改文件扩展列表 (我们应该改变这个现状). 所以你必须做一个要解析的文件列表, 命名为&rsquo;cscope.files&rsquo;(如果用 &lsquo;cscope -i foofile&rsquo;命令，就可以随意命名). 有一个简单（而且十分灵活）的方法是通过 Unix 的&rsquo;find&rsquo;命令:</p><pre><code>find . -name '*.java' &gt; cscope.files
</code></pre><p>然后执行 &lsquo;cscope -b&rsquo; 重新构建数据库(‘-b’会让 Cscope 只构建数据库而不启动 GUI), 你就可以浏览 Java 文件中的所有标识符. 很多人用 Cscope 来浏览和编辑大量的文档文件, 说明 Cscope 解析器是非常灵活的。</p><p>对于大的项目,你可能需要用 -q 选项, 并且使用更复杂的 &lsquo;find&rsquo; 命令. 在 tutorial on using Cscope with large projects 可以得到更多信息.</p><p>11.</p><p>尝试通过设置 $CSCOPE_DB 环境变量来指定一个你创建的 Cscope 数据库, 这样就不用总是在数据库的目录下启动 Vim. 这种用法多用于代码分别放在多个子目录的项目。注意: 这种情况下, 应该用绝对路径来构建数据库: cd to / ,然后：</p><pre><code>find /my/project/dir -name '*.c' -o -name '*.h' &gt; /foo/cscope.files
</code></pre><p>然后在 cscope.files 的目录下运行 Cscope (或者用 &lsquo;cscope -i /foo/cscope.files&rsquo;), 然后设置并到处 $CSCOPE_DB 变量, 让它指向 cscope.out 文件):</p><pre><code>cd /foo
cscope -b
CSCOPE_DB=/foo/cscope.out; export CSCOPE_DB   
</code></pre><p>(上面最后一条命令是针对 Bourne/Korn/Bash 的: 我已经忘了在基于 csh 的 shell 中如何导出变量, 因为我不喜欢它).</p><p>现在应该可以在任何目录下运行 &lsquo;vim -t foo&rsquo; ，并且会准确的跳到定义 &lsquo;foo&rsquo; 的地方. 我通常会为不同的项目写一个小的 shell 脚本 (仅用于定义和导出 CSCOPE_DB) , 以后只需用一个 &lsquo;source projectA&rsquo; 命令来选择它们.</p><blockquote><p>BUG: 在 Cscope V15.4 之前的版本, 有一个愚蠢的Bug，当执行上面的命令时，可能会导致Vim 停止工作，除非你调用你的数据库是不用默认的‘cscope.out&rsquo;：用’-f foo&rsquo;命名为‘foo.out&rsquo;。</p></blockquote><p>12.</p><p>就是这样！如果有什么问题的话就用&rdquo;:help cscope&rdquo; (Vim) 或 &ldquo;man cscope&rdquo; (根据你的 shell) , 还可以学习细微之处.</p><p><em>Cscope support added to Vim by Andy Kahn</em></p><p><em>Tutorial and cscope_maps.vim by Jason Duell</em></p><p><em>Cscope art by Petr Sorfa</em></p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>497 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2012-04-29 00:00 &#43;0000</p></div><div class=pagination><div class=pagination__title><span class=pagination__title-h></span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://shaocheng.li/posts/2012/06/01/><span class=button__icon>←</span>
<span class=button__text>在 Redhat9 文本系统上安装 Qt/E 4.4.0</span></a></span>
<span class="button next"><a href=https://shaocheng.li/posts/2012/04/28/><span class=button__text>在大项目中使用 Cscope</span>
<span class=button__icon>→</span></a></span></div></div><div id=comments class=thin><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"shaocheng-li"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2021</span>
<span><a href=https://shaocheng.li>Shaocheng.Li</a></span>
<span><a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a></span>
<span><a href=https://shaocheng.li/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"/><path d="M4 4a16 16 0 0 1 16 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div><div class=footer__inner><div class=footer__content><span>Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>Made with &#10084; by <a href=https://github.com/rhazdon>rhazdon</a></span></div></div></footer></div><script type=text/javascript src=https://shaocheng.li/bundle.min.2d5469329143160ae2456a69c3c76dc2d0a3b212b46afe291a51bd68650ed6f8697e001dab54f1c272c77ce08092a8c55e5bb4314e0ee334aab4b927ec896638.js integrity="sha512-LVRpMpFDFgriRWppw8dtwtCjshK0av4pGlG9aGUO1vhpfgAdq1TxwnLHfOCAkqjFXlu0MU4O4zSqtLkn7IlmOA=="></script></body></html>